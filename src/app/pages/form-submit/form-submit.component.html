<main class="form-container container">
  <div class="bg-img"></div>

  <!-- To show loading spinner -->
  <app-progress-spinner *ngIf="isFormDetailsLoading"></app-progress-spinner>

  <!-- To show success message -->
  <app-success
    *ngIf="isFormSubmitted"
    message="Form successfully submitted"
  ></app-success>

  <p-card
    *ngIf="
      isFormDetailsLoading == false && isFormSubmitted == false && form != null
    "
    [header]="form.title"
  >
    <ng-template pTemplate="header">
      <div class="form-info" *ngIf="isAlreadySubmitted">
        <p-messages
          [(value)]="alreadySubmitMessage"
          [enableService]="false"
          [closable]="false"
        />
      </div>
    </ng-template>
    <p class="m-0">{{ form.description }}</p>
    <br />
    <form
      [formGroup]="formGroup"
      *ngIf="isAlreadySubmitted == false; else alreadySubmitted"
    >
      <app-dynamic-form
        *ngIf="isFormDetailsLoading == false"
        [formFields]="form.formFields"
        [formGroup]="formGroup"
      ></app-dynamic-form>
      <br />
      <div class="d-flex j-end a-center">
        <p-button
          type="button"
          [label]="isFormSubmitted ? 'Done' : 'Submit'"
          [icon]="isFormSubmitted ? 'pi pi-check' : ''"
          [loading]="isLoading"
          (onClick)="handleSubmitForm($event)"
          [disabled]="formGroup.disabled"
          size="small"
        />
      </div>
    </form>

    <ng-template #alreadySubmitted>
      <app-form-view-submission
        [formFields]="form.formFields"
        [answers]="answers"
      ></app-form-view-submission>
    </ng-template>
  </p-card>
  <app-mini-footer></app-mini-footer>
</main>
